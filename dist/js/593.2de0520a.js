"use strict";(self["webpackChunkcloud_dist"]=self["webpackChunkcloud_dist"]||[]).push([[593],{34531:function(e,a,t){t.d(a,{HZ:function(){return i},bX:function(){return o},uN:function(){return n}});var l=t(37245);function n(e){return(0,l.Z)({url:"/activation-codes",method:"get",params:e})}function o(e){return(0,l.Z)({url:"/activation-codes",method:"post",data:e})}function i(e){return(0,l.Z)({url:`/activation-codes/${e}`,method:"put"})}},35593:function(e,a,t){t.r(a),t.d(a,{default:function(){return W}});var l=t(73396),n=t(44870),o=t(24120),i=t(55393),u=t(5941),c=t(92097),d=t(24165),r=t(33008),s=t(99436),v=t(26429),m=t(83273),_=t(43612),p=t(59063),f=t(34531),g=t(36797),y=t.n(g),b=t(18134),U=t.n(b);const S={class:"activation-code-manage-container"},w={style:{display:"flex","flex-direction":"column"}};var h={__name:"ActivationManage",setup(e){const{message:a}=(0,o.M)(["message"]),t=!0,g=!1,b=[{label:"已使用",value:t},{label:"未使用",value:g}],h=[{label:"1个月",value:2592e3},{label:"2个月",value:5184e3},{label:"3个月",value:7776e3},{label:"6个月",value:15552e3},{label:"1年",value:31536e3},{label:"2年",value:63072e3},{label:"3年",value:94608e3},{label:"4年",value:126144e3}],Z=[{title:"编号",key:"activation_code.id"},{title:"激活码",key:"activation_code.code",render(e){return(0,l.h)(i.ZP,{"data-clipboard-text":e.activation_code.code,id:e.activation_code.code,onClick(){P(e.activation_code.code),a.success("复制成功！")}},e.activation_code.code)}},{title:"激活分区",key:"category.name"},{title:"有效期",key:"activation_code.valid_duration",render(e){return(0,l.h)("span",null,e.activation_code.valid_duration/86400+"天")}},{title:"状态",key:"status",render(e){return(0,l.h)("span",{style:{color:e.activation_code.user_id?"red":"green"}},e.activation_code.user_id?"已使用":"未使用")}},{title:"创建时间",key:"created_time",render(e){return(0,l.h)("span",null,y()(1e3*e.activation_code.created_time).format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"用户ID",key:"user_id",render(e){return(0,l.h)("span",null,e.activation_code.user_id||"--")}},{title:"使用时间",key:"use_time",render(e){return(0,l.h)("span",null,e.activation_code.use_time?y()(1e3*e.activation_code.use_time).format("YYYY-MM-DD HH:mm:ss"):"--")}}];let k=null,W=(0,n.iH)(!0),D=(0,n.iH)(null);Y();const P=e=>{k||H(e),k.on("success",(a=>{console.log("copy succ"),a.clearSelection(),H(e)})),k.on("error",(e=>{console.log("copy fail")}))},H=e=>{k&&k.destroy(),k=null,k=new(U())(`#${e}`)};async function Y(){const e=await(0,p.$R)();D.value=e.items||[],W.value=!1}const x=()=>{I.value.page_num=1,$()},C=()=>{I.value.category_id=null,I.value.activated=null,I.value.key=null},M=(0,n.iH)(null),q=(0,n.qj)({isShow:!1,title:"创建激活码",formData:(0,n.iH)({category_id:null,valid_duration:null,activation_code_count:null}),rules:{category_id:{required:!0,trigger:["blur","change"],message:"请选择分区",type:"number"},valid_duration:{required:!0,trigger:["blur","change"],message:"请选择有效期",type:"number"},activation_code_count:{required:!0,trigger:["blur","input"],message:"请输入数量"}}});function z(){M.value?.validate((async e=>{e||(await(0,f.bX)({...q.formData,activation_code_count:parseInt(q.formData.activation_code_count)}),q.isShow=!1,a.success("操作成功！"),$())})).catch()}(0,l.YP)((()=>q.isShow),(e=>{if(!e)for(const a in q.formData)Object.hasOwnProperty.call(q.formData,a)&&(q.formData[a]=null)}));const I=(0,n.iH)({page_num:1,page_size:10,category_id:null,activated:null,key:null}),O=(0,n.iH)(0),V=(0,n.iH)([]);async function $(){const e=await(0,f.uN)(I.value);V.value=e.activation_codes||[],O.value=e.total}function j(e){I.value.page_num=e,$()}return $(),(e,a)=>((0,l.wg)(),(0,l.iD)("div",S,[(0,l.Wm)((0,n.SU)(u.Z),{class:"filter"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.ZP),{"label-placement":"left",label:"激活分区"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:I.value.category_id,"onUpdate:value":a[0]||(a[0]=e=>I.value.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(D),style:{width:"150px"},clearable:""},null,8,["value","options"])])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{"label-placement":"left",label:"状态"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:I.value.activated,"onUpdate:value":a[1]||(a[1]=e=>I.value.activated=e),options:b,style:{width:"150px"},clearable:""},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{"label-placement":"left",label:"关键字"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(r.Z),{value:I.value.key,"onUpdate:value":a[2]||(a[2]=e=>I.value.key=e),placeholder:"激活码",clearable:""},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{"label-placement":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(i.ZP),{type:"primary",onClick:x},{default:(0,l.w5)((()=>[(0,l.Uk)(" 查询 ")])),_:1})])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{"label-placement":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(i.ZP),{onClick:C},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1}),(0,l.Wm)((0,n.SU)(u.Z),{class:"action"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(i.ZP),{type:"primary",onClick:a[3]||(a[3]=e=>q.isShow=!0)},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增激活码 ")])),_:1})])),_:1}),(0,l._)("div",w,[(0,l.Wm)((0,n.SU)(s.Z),{loading:(0,n.SU)(W),columns:Z,data:V.value,bordered:!1,"on-update:page":e=>I.value.page_num=e,"on-update:page-size":e=>I.value.page_size=e},null,8,["loading","data","on-update:page","on-update:page-size"]),(0,l.Wm)((0,n.SU)(v.Z),{page:I.value.page_num,"onUpdate:page":a[4]||(a[4]=e=>I.value.page_num=e),"item-count":O.value,"on-update:page":j,style:{"align-self":"flex-end","margin-top":"10px"}},null,8,["page","item-count"])]),(0,l.Wm)((0,n.SU)(_.Z),{modelValue:q.isShow,"onUpdate:modelValue":a[8]||(a[8]=e=>q.isShow=e),title:q.title,onOnConfirm:z},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(m.Z),{ref_key:"activationRef",ref:M,model:q.formData,rules:q.rules,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.ZP),{label:"激活分区",path:"category_id"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:q.formData.category_id,"onUpdate:value":a[5]||(a[5]=e=>q.formData.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(D)},null,8,["value","options"])])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{label:"有效期",path:"valid_duration"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:q.formData.valid_duration,"onUpdate:value":a[6]||(a[6]=e=>q.formData.valid_duration=e),options:h},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(c.ZP),{label:"数量",path:"activation_code_count"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(r.Z),{value:q.formData.activation_code_count,"onUpdate:value":a[7]||(a[7]=e=>q.formData.activation_code_count=e)},null,8,["value"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])]))}},Z=t(40089);const k=(0,Z.Z)(h,[["__scopeId","data-v-144481b7"]]);var W=k}}]);
//# sourceMappingURL=593.2de0520a.js.map