"use strict";(self["webpackChunkcloud_dist"]=self["webpackChunkcloud_dist"]||[]).push([[676],{44676:function(e,s,t){t.r(s),t.d(s,{default:function(){return I}});t(57658);var r=t(73396),n=t(87139),a=t(44870),u=t(75869),c=t(74786),i=t(28040),o=t(19785),l=t(22483),d=t(59684),m=t(10796),_=t(137),p=t.n(_),y=t(45140),g=t(20065);const w={class:"res-detail-container"},f={class:"header"},v={class:"title"},h={class:"name"},N={class:"content"},C=["id"],R=["id","src"];var k={__name:"ResourceDetail",setup(e){const s=(0,l.yj)(),t=(0,l.tv)(),_=(0,g.oR)(),k=(0,a.qj)({dataList:[],resCurrentNum:0,resTotalNums:0,resName:"",currentRes:(0,a.iH)(null)});function q(){try{const e=[m.U5.FAVORITE,m.U5.MY_FAVORITE].includes(_.state.selectedCategory.id);e?I():S()}catch(e){}}async function S(){const e=await(0,d.rT)(s.query),t=e.resources||[];k.dataList=t,k.resTotalNums=e.total,t.find(((e,t)=>{e.id==s.query.currentId&&(k.resCurrentNum=t+1,k.resName=e.name,k.currentRes=e)}))}async function I(){const e=await(0,y.P$)({page_num:s.query.page_num,page_size:s.query.page_size,resource_type:s.query.resource_type,favorite_type:_.state.selectedCategory.id}),t=(e.likes||[]).map((e=>({...e.resource,has_permissions:e.has_permissions})));k.dataList=t,k.resTotalNums=e.total,t.find(((e,t)=>{e.id==s.query.currentId&&(k.resCurrentNum=t+1,k.resName=e.name,k.currentRes=e)}))}function T(){if(p().isSupported()){const e=new(p()),s=document.querySelector("#"+("video"+k.currentRes.id));e.loadSource((0,m.Kn)(k.currentRes.video_url)),e.attachMedia(s),s.play()}else console.warn("当前浏览器不支持Hls.js")}q(),(0,r.YP)((()=>_.state.selectedCategory),(e=>{q()})),(0,r.YP)((()=>k.currentRes),(e=>{"VIDEO"===e.resource_type&&(0,r.Y3)((()=>{T()}))}));const D=[o.W_],U=e=>{e.slideTo(k.resCurrentNum-1),console.log(e)},z=e=>{k.resCurrentNum=e.realIndex+1,console.log("slide change")};function j(){t.push({path:"/resource"})}return(e,s)=>((0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("div",f,[(0,r._)("div",v,[(0,r._)("div",h,(0,n.zw)(k.resName),1),(0,r._)("div",null,(0,n.zw)(k.resCurrentNum)+"/"+(0,n.zw)(k.resTotalNums)+"个文件",1)]),(0,r.Wm)((0,a.SU)(c.g),{class:"close-btn",size:"20",onClick:j},{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(u.Z),{class:"close-icon"})])),_:1})]),(0,r._)("div",N,[k.currentRes?((0,r.wg)(),(0,r.j4)((0,a.SU)(i.tq),{key:0,navigation:!0,modules:D,class:"res-swiper",onSwiper:U,onSlideChange:z},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(k.dataList,(e=>((0,r.wg)(),(0,r.j4)((0,a.SU)(i.o5),{class:"res-item"},{default:(0,r.w5)((()=>["VIDEO"===e.resource_type?((0,r.wg)(),(0,r.iD)("video",{key:0,id:"video"+e.id,class:"res",muted:"",controls:"",controlsList:"nodownload"},null,8,C)):((0,r.wg)(),(0,r.iD)("img",{key:1,id:"picture"+e.id,src:(0,a.SU)(m.Kn)(e.picture_url),style:{"":"100%","max-height":"100%"}},null,8,R))])),_:2},1024)))),256))])),_:1})):(0,r.kq)("",!0)])]))}},q=t(40089);const S=(0,q.Z)(k,[["__scopeId","data-v-5eb6cd58"]]);var I=S}}]);
//# sourceMappingURL=676.1d21a61d.js.map