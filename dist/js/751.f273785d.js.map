{"version":3,"file":"js/751.f273785d.js","mappings":"2eA8DA,MAAM,QAAEA,EAAO,OAAEC,IAAWC,EAAAA,EAAAA,GAAkB,CAAC,UAAW,WAEpDC,EAAW,OACXC,EAAW,OACXC,GAAiBC,EAAAA,EAAAA,IAAI,MACrBC,GAAeC,EAAAA,EAAAA,IAAS,CAC5BC,KAAM,CACJC,GAAI,EACJC,MAAO,MAETC,KAAM,CACJF,GAAI,EACJC,OAAOL,EAAAA,EAAAA,IAAI,SAGTO,GAAUP,EAAAA,EAAAA,IAAI,IAEpBQ,eAAeC,IACTR,EAAaE,KAAKE,aACdK,EAAAA,EAAAA,GAAqBT,EAAaE,KAAKC,GAAI,CAC/CC,MAAOJ,EAAaE,KAAKE,QAIzBJ,EAAaK,KAAKD,aACdK,EAAAA,EAAAA,GAAqBT,EAAaK,KAAKF,GAAI,CAC/CC,MAAOJ,EAAaK,KAAKD,QAI7BX,EAAQiB,QAAQ,QAClB,CAEAH,eAAeI,IACb,MAAMC,QAAYC,EAAAA,EAAAA,KACZC,EAAWF,EAAIG,gBAAkB,GACvC,GAAID,EAASE,OAAQ,CACnB,MAAMC,EAAcH,EAASI,MAAMC,GAASA,EAAKC,MAAQxB,IACnDyB,EAAcP,EAASI,MAAMC,GAASA,EAAKC,MAAQvB,IACrDoB,IAEFjB,EAAaE,KAAKE,MAAQa,EAAYb,OAEpCiB,IAEFrB,EAAaK,KAAKD,MAAQiB,EAAYjB,MACtCE,EAAQF,OAAQkB,EAAAA,EAAAA,IAAeD,EAAYjB,OAE/C,CACF,CAEA,MAAMmB,GAAYxB,EAAAA,EAAAA,IAAI,MAEtB,SAASyB,GAAS,KAAEC,IAClBF,EAAUnB,MAAQqB,EAClBA,EAAKC,OAAS,YACdD,EAAKE,WAAa,EAClB,MAAMC,EAAQC,aAAY,KACO,aAA3BN,EAAUnB,MAAMsB,OAIpBH,EAAUnB,MAAMuB,YAA8B,GAAhBG,KAAKC,SAHjCC,cAAcJ,EAGgC,GAC/C,MACHK,EAAAA,EAAAA,GAAYR,GAAMS,MAAK,EAAGC,UACxBnC,EAAaK,KAAKD,MAAQ+B,EAC1B7B,EAAQF,OAAQkB,EAAAA,EAAAA,IAAea,GAC/BZ,EAAUnB,MAAMuB,WAAa,IAC7BS,YAAW,KACTb,EAAUnB,MAAMsB,OAAS,UAAU,GAClC,EAAE,GAET,C,OAEAf,I,w2CClIA,MAAM0B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cloud_dist/./src/views/pc/SettingsManage.vue","webpack://cloud_dist/./src/views/pc/SettingsManage.vue?052d"],"sourcesContent":["<template>\r\n  <div class=\"settings-manage-container\">\r\n    <div class=\"website\">\r\n      <n-form\r\n        ref=\"websiteFormRef\"\r\n        :model=\"settingsData\"\r\n        label-placement=\"left\"\r\n        label-width=\"auto\"\r\n        require-mark-placement=\"right-hanging\"\r\n      >\r\n        <n-form-item label=\"网站名称\">\r\n          <n-input\r\n            v-model:value=\"settingsData.name.value\"\r\n            placeholder=\"请输入网站名称\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"logo\">\r\n          <n-upload directory-dnd @change=\"onUpload\">\r\n            <n-upload-dragger>\r\n              <div style=\"margin-bottom: 12px\">\r\n                <n-icon size=\"48\" :depth=\"3\">\r\n                  <add />\r\n                </n-icon>\r\n              </div>\r\n              <n-text style=\"font-size: 16px\"> 上传图片 </n-text>\r\n              <n-p depth=\"3\" style=\"margin: 8px 0 0 0\">\r\n                (图片大小不超过1M）\r\n              </n-p>\r\n            </n-upload-dragger>\r\n          </n-upload>\r\n        </n-form-item>\r\n        <n-form-item label=\"当前logo图片\">\r\n          <n-image v-if=\"logoUrl\" width=\"100\" :src=\"logoUrl\"></n-image>\r\n        </n-form-item>\r\n        <n-form-item>\r\n          <n-button type=\"primary\" @click=\"save\"> 保存 </n-button>\r\n        </n-form-item>\r\n      </n-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Add } from '@vicons/ionicons5';\r\nimport {\r\n  createDiscreteApi,\r\n  NIcon,\r\n  NInput,\r\n  NForm,\r\n  NFormItem,\r\n  NUpload,\r\n  NUploadDragger,\r\n  NText,\r\n  NP,\r\n  NButton,\r\n  NImage,\r\n} from 'naive-ui';\r\nimport { ref, reactive } from 'vue';\r\nimport { getSettingConfigs, updateSettingConfigs } from '@/api/setting';\r\nimport { parseUrlToPath } from '@/common/global';\r\nimport { postPicture } from '@/api/file';\r\n\r\nconst { message, dialog } = createDiscreteApi(['message', 'dialog']);\r\n\r\nconst KEY_NAME = 'name';\r\nconst KEY_LOGO = 'logo';\r\nconst websiteFormRef = ref(null);\r\nconst settingsData = reactive({\r\n  name: {\r\n    id: 1,\r\n    value: null,\r\n  },\r\n  logo: {\r\n    id: 2,\r\n    value: ref(null),\r\n  },\r\n});\r\nconst logoUrl = ref('');\r\n\r\nasync function save() {\r\n  if (settingsData.name.value) {\r\n    await updateSettingConfigs(settingsData.name.id, {\r\n      value: settingsData.name.value,\r\n      // key: KEY_NAME,\r\n    });\r\n  }\r\n  if (settingsData.logo.value) {\r\n    await updateSettingConfigs(settingsData.logo.id, {\r\n      value: settingsData.logo.value,\r\n      // key: KEY_LOGO,\r\n    });\r\n  }\r\n  message.success('操作成功！');\r\n}\r\n\r\nasync function render() {\r\n  const res = await getSettingConfigs();\r\n  const dataList = res.system_configs || [];\r\n  if (dataList.length) {\r\n    const nameSetting = dataList.find((item) => item.key === KEY_NAME);\r\n    const logoSetting = dataList.find((item) => item.key === KEY_LOGO);\r\n    if (nameSetting) {\r\n      // settingsData.name.id = nameSetting.id;\r\n      settingsData.name.value = nameSetting.value;\r\n    }\r\n    if (logoSetting) {\r\n      // settingsData.logo.id = logoSetting.id;\r\n      settingsData.logo.value = logoSetting.value;\r\n      logoUrl.value = parseUrlToPath(logoSetting.value);\r\n    }\r\n  }\r\n}\r\n\r\nconst uplodFile = ref(null);\r\n\r\nfunction onUpload({ file }) {\r\n  uplodFile.value = file;\r\n  file.status = 'uploading';\r\n  file.percentage = 0;\r\n  const timer = setInterval(() => {\r\n    if (uplodFile.value.status === 'finished') {\r\n      clearInterval(timer);\r\n      return;\r\n    }\r\n    uplodFile.value.percentage += Math.random() * 30;\r\n  }, 1000);\r\n  postPicture(file).then(({ url }) => {\r\n    settingsData.logo.value = url;\r\n    logoUrl.value = parseUrlToPath(url);\r\n    uplodFile.value.percentage = 100;\r\n    setTimeout(() => {\r\n      uplodFile.value.status = 'finished';\r\n    }, 0);\r\n  });\r\n}\r\n\r\nrender();\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.settings-manage-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n  .website {\r\n    max-width: 400px;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./SettingsManage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingsManage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SettingsManage.vue?vue&type=style&index=0&id=4ff57eb8&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\my\\\\cloud_dist\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4ff57eb8\"]])\n\nexport default __exports__"],"names":["message","dialog","createDiscreteApi","KEY_NAME","KEY_LOGO","websiteFormRef","ref","settingsData","reactive","name","id","value","logo","logoUrl","async","save","updateSettingConfigs","success","render","res","getSettingConfigs","dataList","system_configs","length","nameSetting","find","item","key","logoSetting","parseUrlToPath","uplodFile","onUpload","file","status","percentage","timer","setInterval","Math","random","clearInterval","postPicture","then","url","setTimeout","__exports__"],"sourceRoot":""}