{"version":3,"file":"js/611.2eca7da1.js","mappings":"sSAEO,SAASA,EAAsBC,GACpC,OAAOC,EAAAA,EAAAA,GAAQ,CACbC,IAAK,oBACLC,OAAQ,MACRH,UAEJ,CAEO,SAASI,EAAqBC,GACnC,OAAOJ,EAAAA,EAAAA,GAAQ,CACbC,IAAK,oBACLC,OAAQ,OACRE,QAEJ,C,6FC4IA,MAAM,QAAEC,IAAYC,EAAAA,EAAAA,GAAkB,CAAC,YAEjCC,EAAY,EACZC,EAAc,EACdC,EAAgB,CACpB,CACEC,MAAO,MACPC,MAAOJ,GAET,CACEG,MAAO,MACPC,MAAOH,IAGLI,EAAuB,CAC3B,CACEF,MAAO,MACPC,MAAO,IAET,CACED,MAAO,MACPC,MAAO,IAET,CACED,MAAO,MACPC,MAAO,IAET,CACED,MAAO,MACPC,MAAO,KAET,CACED,MAAO,KACPC,MAAO,KAET,CACED,MAAO,KACPC,MAAO,KAET,CACED,MAAO,KACPC,MAAO,MAET,CACED,MAAO,KACPC,MAAO,OAGLE,EAAU,CACd,CACEC,MAAO,KACPC,IAAK,MAEP,CACED,MAAO,MACPC,IAAK,QAEP,CACED,MAAO,OACPC,IAAK,eAEP,CACED,MAAO,MACPC,IAAK,kBAEP,CACED,MAAO,KACPC,IAAK,SACLC,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GACL,OACA,CACEC,MAAO,CACLC,MAAOH,EAAII,SAAW,MAAQ,UAGlCJ,EAAII,SAAW,MAAQ,MAE3B,GAEF,CACEP,MAAO,OACPC,IAAK,gBAEP,CACED,MAAO,OACPC,IAAK,UACLC,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GAAE,OAAQ,KAAMD,EAAIK,SAAW,KACxC,GAEF,CACER,MAAO,OACPC,IAAK,WACLC,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GAAE,OAAQ,KAAMD,EAAII,UAAY,KACzC,IAIJ,IAAIE,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAA2BD,EAAAA,EAAAA,IAAI,MAInCE,eAAeC,IACb,MAAMC,QAAYC,EAAAA,EAAAA,MAClBJ,EAAyBd,MAAQiB,EAAIE,OAAS,GAC9CP,EAAQZ,OAAQ,CAClB,CANAgB,IAQA,MAAMI,GAASC,EAAAA,EAAAA,IAAS,CACtBC,OAAQ,KACRC,MAAO,OAEHA,EAAQ,OACRC,EAAQ,OAERC,GAAgBZ,EAAAA,EAAAA,IAAI,MACpBa,GAAaL,EAAAA,EAAAA,IAAS,CAC1BM,QAAQ,EACRxB,MAAO,QACPyB,UAAUf,EAAAA,EAAAA,IAAI,CACZgB,YAAa,KACbC,eAAgB,KAChBC,sBAAuB,OAEzBC,MAAO,CACLH,YAAa,CACXI,UAAU,EACVC,QAAS,CAAC,OAAQ,UAClBxC,QAAS,QACTyC,KAAM,UAERL,eAAgB,CACdG,UAAU,EACVC,QAAS,CAAC,OAAQ,UAClBxC,QAAS,SACTyC,KAAM,UAERJ,sBAAuB,CACrBE,UAAU,EACVC,QAAS,CAAC,OAAQ,SAClBxC,QAAS,YAKf,SAAS0C,IACPX,EAAczB,OACVqC,UAAStB,UACJuB,UACG9C,EAAqB,IACtBkC,EAAWE,SACdG,sBAAuBQ,SACrBb,EAAWE,SAASG,yBAGxBrC,EAAQ8C,QAAQ,SAClB,IAEDC,OACL,EAEAC,EAAAA,EAAAA,KACE,IAAMhB,EAAWC,SAChBgB,IACC,IAAKA,EACH,IAAK,MAAMvC,KAAOsB,EAAWE,SACvBgB,OAAOC,eAAeC,KAAKpB,EAAWE,SAAUxB,KAClDsB,EAAWE,SAASxB,GAAO,KAGjC,IAIJ,MAAM2C,GAAmBlC,EAAAA,EAAAA,IAAI,CAC3BmC,SAAU,EACVC,UAAW,KAIblC,eAAemC,UACK/D,EAAsB4D,EAAiB/C,MAE3D,C,OAEAkD,I,2xFClVA,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cloud_dist/./src/api/activation.js","webpack://cloud_dist/./src/views/pc/ActivationManage.vue","webpack://cloud_dist/./src/views/pc/ActivationManage.vue?6632"],"sourcesContent":["import request from '@/common/request';\r\n\r\nexport function getActivationCodeList(params) {\r\n  return request({\r\n    url: '/activation-codes',\r\n    method: 'get',\r\n    params,\r\n  });\r\n}\r\n\r\nexport function createActivationCode(data) {\r\n  return request({\r\n    url: '/activation-codes',\r\n    method: 'post',\r\n    data,\r\n  });\r\n}\r\n\r\nexport function useActivationCode(code) {\r\n  return request({\r\n    url: `/activation-codes/${code}`,\r\n    method: 'put',\r\n  });\r\n}\r\n","<template>\r\n  <div class=\"activation-code-manage-container\">\r\n    <n-space class=\"filter\">\r\n      <n-form-item label-placement=\"left\" label=\"激活分区\">\r\n        <n-select\r\n          v-model:value=\"filter.status\"\r\n          label-field=\"name\"\r\n          value-field=\"id\"\r\n          :options=\"categoryListWithOneLevel\"\r\n          style=\"width: 150px\"\r\n        />\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\" label=\"状态\">\r\n        <n-select\r\n          v-model:value=\"filter.status\"\r\n          :options=\"statusOptions\"\r\n          style=\"width: 150px\"\r\n        />\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\" label=\"关键字\">\r\n        <n-input v-model:value=\"filter.query\" placeholder=\"激活码\"></n-input>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button type=\"primary\" @click=\"query\"> 查询 </n-button>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button @click=\"reset\"> 重置 </n-button>\r\n      </n-form-item>\r\n    </n-space>\r\n\r\n    <n-space class=\"action\">\r\n      <n-button type=\"primary\" @click=\"activation.isShow = true\">\r\n        新增激活码\r\n      </n-button>\r\n    </n-space>\r\n\r\n    <!-- <n-form\r\n        size=\"medium\"\r\n        label-placement=\"left\"\r\n        label-width=\"auto\"\r\n        inline\r\n        :model=\"filterFormData\"\r\n      >\r\n        <n-form-item label=\"激活分区\">\r\n          <n-select\r\n            v-model:value=\"filterFormData.dist\"\r\n            placeholder=\"请选择\"\r\n            :options=\"statusOptions\"\r\n            style=\"width: 150px\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"状态\">\r\n          <n-select\r\n            v-model:value=\"filterFormData.status\"\r\n            :options=\"statusOptions\"\r\n            placeholder=\"请选择\"\r\n            style=\"width: 150px\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"关键字\">\r\n          <n-input\r\n            v-model:value=\"filterFormData.cdkey\"\r\n            placeholder=\"激活码\"\r\n          ></n-input>\r\n        </n-form-item>\r\n        <n-form-item>\r\n          <n-button\r\n            type=\"primary\"\r\n            attr-type=\"button\"\r\n            @click=\"query\"\r\n            style=\"margin-right: 20px\"\r\n          >\r\n            查询\r\n          </n-button>\r\n          <n-button attr-type=\"button\" @click=\"reset\"> 重置 </n-button>\r\n        </n-form-item>\r\n      </n-form> -->\r\n\r\n    <!-- <div class=\"actions\">\r\n      <n-button\r\n        type=\"primary\"\r\n        attr-type=\"button\"\r\n        style=\"margin-bottom: 10px\"\r\n        @click=\"isShowCdkeyAlert = true\"\r\n      >\r\n        新增激活码\r\n      </n-button>\r\n    </div> -->\r\n\r\n    <n-data-table\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :data=\"data\"\r\n      :pagination=\"true\"\r\n      :bordered=\"false\"\r\n      :on-update:page=\"(page) => (activationParams.page_num = page)\"\r\n      :on-update:page-size=\"(size) => (activationParams.page_size = size)\"\r\n    />\r\n\r\n    <popup-window\r\n      v-model=\"activation.isShow\"\r\n      :title=\"activation.title\"\r\n      @on-confirm=\"onActivationConfirm\"\r\n    >\r\n      <n-form\r\n        ref=\"activationRef\"\r\n        :model=\"activation.formData\"\r\n        :rules=\"activation.rules\"\r\n        label-placement=\"left\"\r\n        label-width=\"auto\"\r\n        require-mark-placement=\"right-hanging\"\r\n      >\r\n        <n-form-item label=\"激活分区\" path=\"category_id\">\r\n          <n-select\r\n            v-model:value=\"activation.formData.category_id\"\r\n            label-field=\"name\"\r\n            value-field=\"id\"\r\n            :options=\"categoryListWithOneLevel\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"有效期\" path=\"valid_duration\">\r\n          <n-select\r\n            v-model:value=\"activation.formData.valid_duration\"\r\n            :options=\"validDurationOptions\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"数量\" path=\"activation_code_count\">\r\n          <n-input v-model:value=\"activation.formData.activation_code_count\" />\r\n        </n-form-item>\r\n      </n-form>\r\n    </popup-window>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  createDiscreteApi,\r\n  NSelect,\r\n  NFormItem,\r\n  NBreadcrumbItem,\r\n  NIcon,\r\n  NInput,\r\n  NForm,\r\n  NTag,\r\n  NSpace,\r\n  NGrid,\r\n  NGridItem,\r\n  NButton,\r\n  NInputNumber,\r\n  NDataTable,\r\n} from 'naive-ui';\r\nimport { ref, h, reactive, watch } from 'vue';\r\nimport PopupWindow from '@/components/pc/PopupWindow';\r\nimport { getCategorieList } from '@/api/categories';\r\nimport { createActivationCode, getActivationCodeList } from '@/api/activation';\r\n\r\nconst { message } = createDiscreteApi(['message']);\r\n\r\nconst TYPE_USED = 0;\r\nconst TYPE_UNUSED = 1;\r\nconst statusOptions = [\r\n  {\r\n    label: '已使用',\r\n    value: TYPE_USED,\r\n  },\r\n  {\r\n    label: '未使用',\r\n    value: TYPE_UNUSED,\r\n  },\r\n];\r\nconst validDurationOptions = [\r\n  {\r\n    label: '1个月',\r\n    value: 30,\r\n  },\r\n  {\r\n    label: '2个月',\r\n    value: 30 * 2,\r\n  },\r\n  {\r\n    label: '3个月',\r\n    value: 30 * 3,\r\n  },\r\n  {\r\n    label: '6个月',\r\n    value: 30 * 6,\r\n  },\r\n  {\r\n    label: '1年',\r\n    value: 365,\r\n  },\r\n  {\r\n    label: '2年',\r\n    value: 365 * 2,\r\n  },\r\n  {\r\n    label: '3年',\r\n    value: 365 * 3,\r\n  },\r\n  {\r\n    label: '4年',\r\n    value: 365 * 4,\r\n  },\r\n];\r\nconst columns = [\r\n  {\r\n    title: '编号',\r\n    key: 'id',\r\n  },\r\n  {\r\n    title: '激活码',\r\n    key: 'code',\r\n  },\r\n  {\r\n    title: '激活分区',\r\n    key: 'category_id',\r\n  },\r\n  {\r\n    title: '有效期',\r\n    key: 'valid_duration',\r\n  },\r\n  {\r\n    title: '状态',\r\n    key: 'status',\r\n    render(row) {\r\n      return h(\r\n        'span',\r\n        {\r\n          style: {\r\n            color: row.use_time ? 'red' : 'green',\r\n          },\r\n        },\r\n        row.use_time ? '已使用' : '未使用'\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: '创建时间',\r\n    key: 'created_time',\r\n  },\r\n  {\r\n    title: '用户ID',\r\n    key: 'user_id',\r\n    render(row) {\r\n      return h('span', null, row.user_id || '--');\r\n    },\r\n  },\r\n  {\r\n    title: '使用时间',\r\n    key: 'use_time',\r\n    render(row) {\r\n      return h('span', null, row.use_time || '--');\r\n    },\r\n  },\r\n];\r\n\r\nlet loading = ref(true);\r\nlet categoryListWithOneLevel = ref(null);\r\n\r\ngetCategoryListWithOneLevel();\r\n\r\nasync function getCategoryListWithOneLevel() {\r\n  const res = await getCategorieList();\r\n  categoryListWithOneLevel.value = res.items || [];\r\n  loading.value = false;\r\n}\r\n\r\nconst filter = reactive({\r\n  status: null,\r\n  query: null,\r\n});\r\nconst query = () => {};\r\nconst reset = () => {};\r\n\r\nconst activationRef = ref(null);\r\nconst activation = reactive({\r\n  isShow: false,\r\n  title: '创建激活码',\r\n  formData: ref({\r\n    category_id: null,\r\n    valid_duration: null,\r\n    activation_code_count: null,\r\n  }),\r\n  rules: {\r\n    category_id: {\r\n      required: true,\r\n      trigger: ['blur', 'change'],\r\n      message: '请选择分区',\r\n      type: 'number',\r\n    },\r\n    valid_duration: {\r\n      required: true,\r\n      trigger: ['blur', 'change'],\r\n      message: '请选择有效期',\r\n      type: 'number',\r\n    },\r\n    activation_code_count: {\r\n      required: true,\r\n      trigger: ['blur', 'input'],\r\n      message: '请输入数量',\r\n    },\r\n  },\r\n});\r\n\r\nfunction onActivationConfirm() {\r\n  activationRef.value\r\n    ?.validate(async (errors) => {\r\n      if (!errors) {\r\n        await createActivationCode({\r\n          ...activation.formData,\r\n          activation_code_count: parseInt(\r\n            activation.formData.activation_code_count\r\n          ),\r\n        });\r\n        message.success('操作成功！');\r\n      }\r\n    })\r\n    .catch();\r\n}\r\n\r\nwatch(\r\n  () => activation.isShow,\r\n  (val) => {\r\n    if (!val) {\r\n      for (const key in activation.formData) {\r\n        if (Object.hasOwnProperty.call(activation.formData, key)) {\r\n          activation.formData[key] = null;\r\n        }\r\n      }\r\n    }\r\n  }\r\n);\r\n\r\nconst activationParams = ref({\r\n  page_num: 1,\r\n  page_size: 10,\r\n});\r\n\r\n\r\nasync function renderActivationList() {\r\n  const res = await getActivationCodeList(activationParams.value);\r\n  // debugger;\r\n}\r\n\r\nrenderActivationList();\r\n\r\n// [\r\n//   {\r\n//     label: '111分区',\r\n//     value: 1,\r\n//   },\r\n// ];\r\n\r\n// const TYPE_CDKEY_USED = 0;\r\n// const TYPE_CDKEY_UN_USED = 1;\r\n\r\n// export default {\r\n//   name: 'CdkeyManage',\r\n//   components: {\r\n//     NForm,\r\n//     NSelect,\r\n//     NFormItem,\r\n//     NInput,\r\n//     NButton,\r\n//     NDataTable,\r\n//     NInputNumber,\r\n//     PopupWindow,\r\n//   },\r\n//   watch: {\r\n//     isShowCdkeyAlert(val) {\r\n//       if (!val) {\r\n//         this.cdkeyFormData.dist = null;\r\n//         this.cdkeyFormData.expiration = null;\r\n//         this.cdkeyFormData.amount = null;\r\n//       }\r\n//     },\r\n//   },\r\n//   setup() {\r\n//     const query = () => {};\r\n//     const reset = () => {};\r\n//     const cdkeyFormRef = ref(null);\r\n//     const isShowCdkeyAlert = ref(false);\r\n//     const addCdkey = () => {\r\n//       cdkeyFormRef.value\r\n//         ?.validate((errors) => {\r\n//           if (!errors) {\r\n//             isShowCdkeyAlert.value = false;\r\n//           }\r\n//         })\r\n//         .catch((e) => {});\r\n//     };\r\n\r\n//     return {\r\n//       isShowCdkeyAlert,\r\n//       filterFormData: ref({\r\n//         dist: null,\r\n//         status: null,\r\n//         cdkey: null,\r\n//       }),\r\n//       statusOptions: [\r\n//         {\r\n//           label: '已使用',\r\n//           value: TYPE_CDKEY_USED,\r\n//         },\r\n//         {\r\n//           label: '未使用',\r\n//           value: TYPE_CDKEY_UN_USED,\r\n//         },\r\n//       ],\r\n//       query,\r\n//       reset,\r\n//       cdkeyFormRef,\r\n//       cdkeyFormData: ref({\r\n//         dist: null,\r\n//         expiration: null,\r\n//         amount: null,\r\n//       }),\r\n//       rules: {\r\n//         dist: {\r\n//           required: true,\r\n//           trigger: ['blur', 'input'],\r\n//           message: '请选择分区',\r\n//         },\r\n//         expiration: {\r\n//           required: true,\r\n//           trigger: ['blur', 'change'],\r\n//           message: '请选择有效期',\r\n//           type: 'number',\r\n//         },\r\n//         amount: {\r\n//           required: true,\r\n//           trigger: ['blur', 'input'],\r\n//           message: '请输入数量',\r\n//         },\r\n//       },\r\n//       expirationOptions: [\r\n//         {\r\n//           label: '1个月',\r\n//           value: 30,\r\n//         },\r\n//         {\r\n//           label: '2个月',\r\n//           value: 30 * 2,\r\n//         },\r\n//         {\r\n//           label: '3个月',\r\n//           value: 30 * 3,\r\n//         },\r\n//         {\r\n//           label: '6个月',\r\n//           value: 30 * 6,\r\n//         },\r\n//         {\r\n//           label: '1年',\r\n//           value: 365,\r\n//         },\r\n//         {\r\n//           label: '2年',\r\n//           value: 365 * 2,\r\n//         },\r\n//         {\r\n//           label: '3年',\r\n//           value: 365 * 3,\r\n//         },\r\n//         {\r\n//           label: '4年',\r\n//           value: 365 * 4,\r\n//         },\r\n//       ],\r\n//       addCdkey,\r\n//       columns: [\r\n//         {\r\n//           title: '编号',\r\n//           key: 'id',\r\n//         },\r\n//         {\r\n//           title: '激活码',\r\n//           key: 'code',\r\n//         },\r\n//         {\r\n//           title: '激活分区',\r\n//           key: 'category_id',\r\n//         },\r\n//         {\r\n//           title: '有效期',\r\n//           key: 'valid_duration',\r\n//         },\r\n//         {\r\n//           title: '状态',\r\n//           key: 'status',\r\n//           render(row) {\r\n//             return h(\r\n//               'span',\r\n//               {\r\n//                 style: {\r\n//                   color: row.use_time ? 'red' : 'green',\r\n//                 },\r\n//               },\r\n//               row.use_time ? '已使用' : '未使用'\r\n//             );\r\n//           },\r\n//         },\r\n//         {\r\n//           title: '创建时间',\r\n//           key: 'created_time',\r\n//         },\r\n//         {\r\n//           title: '用户ID',\r\n//           key: 'user_id',\r\n//           render(row) {\r\n//             return h('span', null, row.user_id || '--');\r\n//           },\r\n//         },\r\n//         {\r\n//           title: '使用时间',\r\n//           key: 'use_time',\r\n//           render(row) {\r\n//             return h('span', null, row.use_time || '--');\r\n//           },\r\n//         },\r\n//       ],\r\n//       data: [\r\n//         {\r\n//           id: '0001',\r\n//           code: '098797832',\r\n//           category_id: 'Game/Mobile game/Videos',\r\n//           valid_duration: '3个月',\r\n//           created_time: '2022.02.16 15:20:34',\r\n//           user_id: '001',\r\n//           use_time: '2022.02.16 15:20:34',\r\n//         },\r\n//         {\r\n//           id: '0001',\r\n//           code: '098797832',\r\n//           category_id: 'Game/Mobile game/Videos',\r\n//           valid_duration: '1个月',\r\n//           created_time: '2022.02.16 15:20:34',\r\n//           user_id: '',\r\n//           use_time: '',\r\n//         },\r\n//         {\r\n//           id: '0001',\r\n//           code: '098797832',\r\n//           category_id: 'Game/Mobile game/Videos',\r\n//           valid_duration: '3个月',\r\n//           created_time: '2022.02.16 15:20:34',\r\n//           user_id: '001',\r\n//           use_time: '2022.02.16 15:20:34',\r\n//         },\r\n//       ],\r\n//     };\r\n//   },\r\n// };\r\n//\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.activation-code-manage-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n  .action {\r\n    margin-bottom: 15px;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./ActivationManage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ActivationManage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ActivationManage.vue?vue&type=style&index=0&id=7193b2d8&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\my\\\\cloud_dist\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7193b2d8\"]])\n\nexport default __exports__"],"names":["getActivationCodeList","params","request","url","method","createActivationCode","data","message","createDiscreteApi","TYPE_USED","TYPE_UNUSED","statusOptions","label","value","validDurationOptions","columns","title","key","render","row","h","style","color","use_time","user_id","loading","ref","categoryListWithOneLevel","async","getCategoryListWithOneLevel","res","getCategorieList","items","filter","reactive","status","query","reset","activationRef","activation","isShow","formData","category_id","valid_duration","activation_code_count","rules","required","trigger","type","onActivationConfirm","validate","errors","parseInt","success","catch","watch","val","Object","hasOwnProperty","call","activationParams","page_num","page_size","renderActivationList","__exports__"],"sourceRoot":""}