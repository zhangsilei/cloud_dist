"use strict";(self["webpackChunkcloud_dist"]=self["webpackChunkcloud_dist"]||[]).push([[441],{4531:function(e,a,t){t.d(a,{HZ:function(){return i},bX:function(){return u},uN:function(){return n}});var l=t(7245);function n(e){return(0,l.Z)({url:"/activation-codes",method:"get",params:e})}function u(e){return(0,l.Z)({url:"/activation-codes",method:"post",data:e})}function i(e){return(0,l.Z)({url:`/activation-codes/${e}`,method:"put"})}},2441:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z}});var l=t(3396),n=t(4870),u=t(4120),i=t(5941),o=t(7646),c=t(4165),d=t(3008),r=t(5393),v=t(9436),s=t(6429),m=t(3273),_=t(3612),p=t(9063),f=t(4531),g=t(6797),b=t.n(g);const y={class:"activation-code-manage-container"},U={style:{display:"flex","flex-direction":"column"}};var S={__name:"ActivationManage",setup(e){const{message:a}=(0,u.M)(["message"]),t=!0,g=!1,S=[{label:"已使用",value:t},{label:"未使用",value:g}],w=[{label:"1个月",value:30},{label:"2个月",value:60},{label:"3个月",value:90},{label:"6个月",value:180},{label:"1年",value:365},{label:"2年",value:730},{label:"3年",value:1095},{label:"4年",value:1460}],h=[{title:"编号",key:"activation_code.id"},{title:"激活码",key:"activation_code.code"},{title:"激活分区",key:"category.name"},{title:"有效期",key:"activation_code.valid_duration",render(e){return(0,l.h)("span",null,e.activation_code.valid_duration+"天")}},{title:"状态",key:"status",render(e){return(0,l.h)("span",{style:{color:e.activation_code.user_id?"red":"green"}},e.activation_code.user_id?"已使用":"未使用")}},{title:"创建时间",key:"created_time",render(e){return(0,l.h)("span",null,b()(1e3*e.activation_code.created_time).format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"用户ID",key:"user_id",render(e){return(0,l.h)("span",null,e.activation_code.user_id||"--")}},{title:"使用时间",key:"use_time",render(e){return(0,l.h)("span",null,e.activation_code.use_time?b()(1e3*e.activation_code.use_time).format("YYYY-MM-DD HH:mm:ss"):"--")}}];let Z=(0,n.iH)(!0),k=(0,n.iH)(null);async function W(){const e=await(0,p.$R)();k.value=e.items||[],Z.value=!1}W();const D=()=>{C.value.page_num=1,z()},P=()=>{C.value.category_id=null,C.value.activated=null,C.value.key=null},H=(0,n.iH)(null),Y=(0,n.qj)({isShow:!1,title:"创建激活码",formData:(0,n.iH)({category_id:null,valid_duration:null,activation_code_count:null}),rules:{category_id:{required:!0,trigger:["blur","change"],message:"请选择分区",type:"number"},valid_duration:{required:!0,trigger:["blur","change"],message:"请选择有效期",type:"number"},activation_code_count:{required:!0,trigger:["blur","input"],message:"请输入数量"}}});function x(){H.value?.validate((async e=>{e||(await(0,f.bX)({...Y.formData,activation_code_count:parseInt(Y.formData.activation_code_count)}),Y.isShow=!1,a.success("操作成功！"),z())})).catch()}(0,l.YP)((()=>Y.isShow),(e=>{if(!e)for(const a in Y.formData)Object.hasOwnProperty.call(Y.formData,a)&&(Y.formData[a]=null)}));const C=(0,n.iH)({page_num:1,page_size:10,category_id:null,activated:null,key:null}),M=(0,n.iH)(0),q=(0,n.iH)([]);async function z(){const e=await(0,f.uN)(C.value);q.value=e.activation_codes||[],M.value=e.total}function I(e){C.value.page_num=e,z()}return z(),(e,a)=>((0,l.wg)(),(0,l.iD)("div",y,[(0,l.Wm)((0,n.SU)(i.Z),{class:"filter"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"激活分区"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.Z),{value:C.value.category_id,"onUpdate:value":a[0]||(a[0]=e=>C.value.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(k),style:{width:"150px"},clearable:""},null,8,["value","options"])])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"状态"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.Z),{value:C.value.activated,"onUpdate:value":a[1]||(a[1]=e=>C.value.activated=e),options:S,style:{width:"150px"},clearable:""},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"关键字"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:C.value.key,"onUpdate:value":a[2]||(a[2]=e=>C.value.key=e),placeholder:"激活码",clearable:""},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{"label-placement":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(r.ZP),{type:"primary",onClick:D},{default:(0,l.w5)((()=>[(0,l.Uk)(" 查询 ")])),_:1})])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{"label-placement":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(r.ZP),{onClick:P},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1}),(0,l.Wm)((0,n.SU)(i.Z),{class:"action"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(r.ZP),{type:"primary",onClick:a[3]||(a[3]=e=>Y.isShow=!0)},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增激活码 ")])),_:1})])),_:1}),(0,l._)("div",U,[(0,l.Wm)((0,n.SU)(v.Z),{loading:(0,n.SU)(Z),columns:h,data:q.value,bordered:!1,"on-update:page":e=>C.value.page_num=e,"on-update:page-size":e=>C.value.page_size=e},null,8,["loading","data","on-update:page","on-update:page-size"]),(0,l.Wm)((0,n.SU)(s.Z),{page:C.value.page_num,"onUpdate:page":a[4]||(a[4]=e=>C.value.page_num=e),"item-count":M.value,"on-update:page":I,style:{"align-self":"flex-end","margin-top":"10px"}},null,8,["page","item-count"])]),(0,l.Wm)((0,n.SU)(_.Z),{modelValue:Y.isShow,"onUpdate:modelValue":a[8]||(a[8]=e=>Y.isShow=e),title:Y.title,onOnConfirm:x},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(m.Z),{ref_key:"activationRef",ref:H,model:Y.formData,rules:Y.rules,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(o.ZP),{label:"激活分区",path:"category_id"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.Z),{value:Y.formData.category_id,"onUpdate:value":a[5]||(a[5]=e=>Y.formData.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(k)},null,8,["value","options"])])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{label:"有效期",path:"valid_duration"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(c.Z),{value:Y.formData.valid_duration,"onUpdate:value":a[6]||(a[6]=e=>Y.formData.valid_duration=e),options:w},null,8,["value"])])),_:1}),(0,l.Wm)((0,n.SU)(o.ZP),{label:"数量",path:"activation_code_count"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,n.SU)(d.Z),{value:Y.formData.activation_code_count,"onUpdate:value":a[7]||(a[7]=e=>Y.formData.activation_code_count=e)},null,8,["value"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])]))}},w=t(89);const h=(0,w.Z)(S,[["__scopeId","data-v-c29afb2a"]]);var Z=h}}]);
//# sourceMappingURL=441.f6c8365a.js.map