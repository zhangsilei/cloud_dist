{"version":3,"file":"js/334.b33441c3.js","mappings":"mjBA8DA,SAASA,IACPC,EAAWC,MAAMC,SAAW,EAC5BC,GACF,CAEA,SAASC,IACPJ,EAAWC,MAAMI,IAAM,IACzB,CAEA,IAAIC,GAAWC,EAAAA,EAAAA,IAAI,IACfC,GAAUD,EAAAA,EAAAA,KAAI,GACdE,GAAiBF,EAAAA,EAAAA,IAAI,GACrBG,GAAiBH,EAAAA,EAAAA,KAAI,GACrBI,GAAcJ,EAAAA,EAAAA,IAAI,MAEtB,MAAMK,GAAQL,EAAAA,EAAAA,IAAI,GACZP,GAAaO,EAAAA,EAAAA,IAAI,CACrBL,SAAU,EACVW,UAAW,GACXR,IAAK,OAEDS,EAAU,CACd,CACEC,MAAO,OACPV,IAAK,MAEP,CACEU,MAAO,MACPV,IAAK,aAEP,CACEU,MAAO,QACPV,IAAK,sBACLW,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GACL,OACA,CACEC,MAAO,CACLC,MAAO,mBACPC,OAAQ,YAGZJ,EAAIK,oBAER,GAEF,CACEP,MAAO,OACPV,IAAK,aAEP,CACEU,MAAO,KACPV,IAAK,SACLW,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GAAE,MAAO,CAAEC,MAAO,CAAEC,MAAO,UAAWC,OAAQ,YAAe,EAClEH,EAAAA,EAAAA,GACE,OACA,CACEK,QAAS,KACPZ,EAAYV,MAAQgB,EACpBP,EAAeT,OAAQ,CAAI,GAG/B,SAGN,KAIJuB,EAAAA,EAAAA,KAAU,KACR,MAAMC,EAAe,GACfC,EAAoB,GACpBC,EAAmB,GACnBC,EAAmB,GACzBnB,EAAeR,MACb4B,SAASC,cAAc,2BAA2BC,aAClDN,EACAC,EACAC,EACAC,CAAgB,IAGpB,MAAM,QAAEI,IAAYC,EAAAA,EAAAA,GAAkB,CAAC,YAEvCC,eAAe/B,IACb,MAAMgC,QAAYC,EAAAA,EAAAA,IAAYpC,EAAWC,OACzCK,EAASL,MAAQkC,EAAIE,OAAS,GAC9B7B,EAAQP,OAAQ,EAChBW,EAAMX,MAAQkC,EAAIvB,KACpB,CAEA,SAAS0B,EAAWC,GAClBvC,EAAWC,MAAMC,SAAWqC,EAC5BpC,GACF,CAIA+B,eAAeM,UACPC,EAAAA,EAAAA,IAAW9B,EAAYV,MAAMyC,GAAI,CAAEC,SAAU,WACnDjC,EAAeT,OAAQ,EACvB+B,EAAQY,QAAQ,QAClB,C,OANAzC,I,uxCCzJA,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cloud_dist/./src/views/pc/UsersManage.vue","webpack://cloud_dist/./src/views/pc/UsersManage.vue?3127"],"sourcesContent":["<template>\r\n  <div class=\"users-manage-container\">\r\n    <n-space class=\"filter\">\r\n      <n-form-item label-placement=\"left\" label=\"关键字\">\r\n        <n-input\r\n          v-model:value=\"userParams.key\"\r\n          placeholder=\"用户名/用户ID/激活码\"\r\n          clearable\r\n        ></n-input>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button type=\"primary\" @click=\"query\"> 查询 </n-button>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button @click=\"reset\"> 重置 </n-button>\r\n      </n-form-item>\r\n    </n-space>\r\n\r\n    <div style=\"display: flex; flex-direction: column\">\r\n      <n-data-table\r\n        :max-height=\"tableMaxHeight\"\r\n        :loading=\"loading\"\r\n        :columns=\"columns\"\r\n        :data=\"userList\"\r\n        :bordered=\"false\"\r\n      />\r\n      <n-pagination\r\n        v-model:page=\"userParams.page_num\"\r\n        :item-count=\"total\"\r\n        :on-update:page=\"changePage\"\r\n        style=\"align-self: flex-end; margin-top: 10px\"\r\n      />\r\n    </div>\r\n\r\n    <popup-window\r\n      v-model=\"isShowPwdAlert\"\r\n      title=\"重置密码\"\r\n      :width=\"300\"\r\n      @on-confirm=\"resetPwd\"\r\n    >\r\n      <div>确定重置密码吗？</div>\r\n      <div>重置后新密码为：123456</div>\r\n    </popup-window>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  createDiscreteApi,\r\n  NFormItem,\r\n  NInput,\r\n  NForm,\r\n  NButton,\r\n  NDataTable,\r\n  NSpace,\r\n  NPagination,\r\n} from 'naive-ui';\r\nimport { ref, h, onMounted, reactive, computed } from 'vue';\r\nimport PopupWindow from '@/components/pc/PopupWindow.vue';\r\nimport { getUserList, updateUser } from '@/api/user';\r\nimport { getTableMaxHeight } from '@/common/global';\r\n\r\nfunction query() {\r\n  userParams.value.page_num = 1;\r\n  renderUserList();\r\n}\r\n\r\nfunction reset() {\r\n  userParams.value.key = null;\r\n}\r\n\r\nlet userList = ref([]);\r\nlet loading = ref(true);\r\nlet tableMaxHeight = ref(0);\r\nlet isShowPwdAlert = ref(false);\r\nlet selectedRow = ref(null);\r\n\r\nconst total = ref(0);\r\nconst userParams = ref({\r\n  page_num: 1,\r\n  page_size: 10,\r\n  key: null,\r\n});\r\nconst columns = [\r\n  {\r\n    title: '用户ID',\r\n    key: 'id',\r\n  },\r\n  {\r\n    title: '用户名',\r\n    key: 'user_name',\r\n  },\r\n  {\r\n    title: '激活码数量',\r\n    key: 'activation_code_num',\r\n    render(row) {\r\n      return h(\r\n        'span',\r\n        {\r\n          style: {\r\n            color: 'rgb(24, 160, 88)',\r\n            cursor: 'pointer',\r\n          },\r\n        },\r\n        row.activation_code_num\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: '用户类型',\r\n    key: 'user_type',\r\n  },\r\n  {\r\n    title: '操作',\r\n    key: 'action',\r\n    render(row) {\r\n      return h('div', { style: { color: '#18a058', cursor: 'pointer' } }, [\r\n        h(\r\n          'span',\r\n          {\r\n            onClick: () => {\r\n              selectedRow.value = row;\r\n              isShowPwdAlert.value = true;\r\n            },\r\n          },\r\n          '重置密码'\r\n        ),\r\n      ]);\r\n    },\r\n  },\r\n];\r\n\r\nonMounted(() => {\r\n  const filterHeight = 58;\r\n  const tableHeaderHeight = 47;\r\n  const paginationHeight = 28 + 12;\r\n  const containerPadding = 10 * 2;\r\n  tableMaxHeight.value =\r\n    document.querySelector('.users-manage-container').offsetHeight -\r\n    filterHeight -\r\n    tableHeaderHeight -\r\n    paginationHeight -\r\n    containerPadding;\r\n});\r\n\r\nconst { message } = createDiscreteApi(['message']);\r\n\r\nasync function renderUserList() {\r\n  const res = await getUserList(userParams.value);\r\n  userList.value = res.users || [];\r\n  loading.value = false;\r\n  total.value = res.total;\r\n}\r\n\r\nfunction changePage(page) {\r\n  userParams.value.page_num = page;\r\n  renderUserList();\r\n}\r\n\r\nrenderUserList();\r\n\r\nasync function resetPwd() {\r\n  await updateUser(selectedRow.value.id, { password: '123456' });\r\n  isShowPwdAlert.value = false;\r\n  message.success('操作成功！');\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.users-manage-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n}\r\n</style>\r\n","import script from \"./UsersManage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UsersManage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UsersManage.vue?vue&type=style&index=0&id=223d3244&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\my\\\\cloud_dist\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-223d3244\"]])\n\nexport default __exports__"],"names":["query","userParams","value","page_num","renderUserList","reset","key","userList","ref","loading","tableMaxHeight","isShowPwdAlert","selectedRow","total","page_size","columns","title","render","row","h","style","color","cursor","activation_code_num","onClick","onMounted","filterHeight","tableHeaderHeight","paginationHeight","containerPadding","document","querySelector","offsetHeight","message","createDiscreteApi","async","res","getUserList","users","changePage","page","resetPwd","updateUser","id","password","success","__exports__"],"sourceRoot":""}