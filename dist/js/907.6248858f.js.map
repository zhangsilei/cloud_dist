{"version":3,"file":"js/907.6248858f.js","mappings":"wLACA,MAAMA,EAAa,CACjBC,MAAO,6BACP,cAAe,+BACfC,QAAS,eAELC,GAA2BC,EAAAA,EAAAA,GAC/B,OACA,CACEC,KAAM,OACNC,OAAQ,eACR,iBAAkB,QAClB,kBAAmB,QACnB,eAAgB,KAChBC,EAAG,gBAEL,MACC,GAGGC,GAA2BJ,EAAAA,EAAAA,GAC/B,OACA,CACEC,KAAM,OACNC,OAAQ,eACR,iBAAkB,QAClB,kBAAmB,QACnB,eAAgB,KAChBC,EAAG,gBAEL,MACC,GAGGE,EAAa,CAACN,EAAYK,GAChC,OAAeE,EAAAA,EAAAA,IAAgB,CAC7BC,KAAM,MACNC,OAAQ,SAAgBC,EAAMC,GAC5B,OAAOC,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAOhB,EAAYS,EAC9D,I,oRCuBF,MAAM,QAAEQ,EAAO,OAAEC,IAAWC,EAAAA,EAAAA,GAAkB,CAAC,UAAW,WAEpDC,EAAW,OACXC,EAAW,OACXC,GAAiBC,EAAAA,EAAAA,IAAI,MACrBC,GAAeC,EAAAA,EAAAA,IAAS,CAC5Bd,KAAM,CACJe,GAAI,EACJC,MAAO,MAETC,KAAM,CACJF,GAAI,EACJC,OAAOJ,EAAAA,EAAAA,IAAI,SAGTM,GAAUN,EAAAA,EAAAA,IAAI,IAEpBO,eAAeC,IACTP,EAAab,KAAKgB,aACdK,EAAAA,EAAAA,GAAqBR,EAAab,KAAKe,GAAI,CAC/CC,MAAOH,EAAab,KAAKgB,QAIzBH,EAAaI,KAAKD,aACdK,EAAAA,EAAAA,GAAqBR,EAAaI,KAAKF,GAAI,CAC/CC,MAAOH,EAAaI,KAAKD,QAI7BV,EAAQgB,QAAQ,QAClB,CAEAH,eAAelB,IACb,MAAMsB,QAAYC,EAAAA,EAAAA,KACZC,EAAWF,EAAIG,gBAAkB,GACvC,GAAID,EAASE,OAAQ,CACnB,MAAMC,EAAcH,EAASI,MAAMC,GAASA,EAAKC,MAAQtB,IACnDuB,EAAcP,EAASI,MAAMC,GAASA,EAAKC,MAAQrB,IACrDkB,IAEFf,EAAab,KAAKgB,MAAQY,EAAYZ,OAEpCgB,IAEFnB,EAAaI,KAAKD,MAAQgB,EAAYhB,MACtCE,EAAQF,OAAQiB,EAAAA,EAAAA,IAAeD,EAAYhB,OAG/C,CACF,CAEA,MAAMkB,GAAYtB,EAAAA,EAAAA,IAAI,MAEtB,SAASuB,GAAS,KAAEC,IAClBF,EAAUlB,MAAQoB,EAClBA,EAAKC,OAAS,YACdD,EAAKE,WAAa,EAClB,MAAMC,EAAQC,aAAY,KACO,aAA3BN,EAAUlB,MAAMqB,OAIpBH,EAAUlB,MAAMsB,YAA8B,GAAhBG,KAAKC,SAHjCC,cAAcJ,EAGgC,GAC/C,MACHK,EAAAA,EAAAA,GAAYR,GAAMS,MAAK,EAAGC,UACxBjC,EAAaI,KAAKD,MAAQ8B,EAC1B5B,EAAQF,OAAQiB,EAAAA,EAAAA,IAAea,GAG/BZ,EAAUlB,MAAMsB,WAAa,IAC7BS,YAAW,KACTb,EAAUlB,MAAMqB,OAAS,UAAU,GAClC,EAAE,GAET,C,OAEApC,I,m2CCrIA,MAAM+C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cloud_dist/./node_modules/@vicons/ionicons5/es/Add.js","webpack://cloud_dist/./src/views/pc/SettingsManage.vue","webpack://cloud_dist/./src/views/pc/SettingsManage.vue?052d"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 512 512'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    fill: 'none',\n    stroke: 'currentColor',\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round',\n    'stroke-width': '32',\n    d: 'M256 112v288'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    fill: 'none',\n    stroke: 'currentColor',\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round',\n    'stroke-width': '32',\n    d: 'M400 256H112'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_4 = [_hoisted_2, _hoisted_3]\nexport default defineComponent({\n  name: 'Add',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_4)\n  }\n})\n","<template>\r\n  <div class=\"settings-manage-container\">\r\n    <div class=\"website\">\r\n      <n-form\r\n        ref=\"websiteFormRef\"\r\n        :model=\"settingsData\"\r\n        label-placement=\"left\"\r\n        label-width=\"auto\"\r\n        require-mark-placement=\"right-hanging\"\r\n      >\r\n        <n-form-item label=\"网站名称\">\r\n          <n-input\r\n            v-model:value=\"settingsData.name.value\"\r\n            placeholder=\"请输入网站名称\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"logo\">\r\n          <n-upload directory-dnd @change=\"onUpload\">\r\n            <n-upload-dragger>\r\n              <div style=\"margin-bottom: 12px\">\r\n                <n-icon size=\"48\" :depth=\"3\">\r\n                  <add />\r\n                </n-icon>\r\n              </div>\r\n              <n-text style=\"font-size: 16px\"> 上传图片 </n-text>\r\n              <n-p depth=\"3\" style=\"margin: 8px 0 0 0\">\r\n                (图片大小不超过1M）\r\n              </n-p>\r\n            </n-upload-dragger>\r\n          </n-upload>\r\n        </n-form-item>\r\n        <n-form-item label=\"当前logo图片\">\r\n          <n-image v-if=\"logoUrl\" width=\"100\" :src=\"logoUrl\"></n-image>\r\n        </n-form-item>\r\n        <n-form-item>\r\n          <n-button type=\"primary\" @click=\"save\"> 保存 </n-button>\r\n        </n-form-item>\r\n      </n-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Add } from '@vicons/ionicons5';\r\nimport {\r\n  createDiscreteApi,\r\n  NIcon,\r\n  NInput,\r\n  NForm,\r\n  NFormItem,\r\n  NUpload,\r\n  NUploadDragger,\r\n  NText,\r\n  NP,\r\n  NButton,\r\n  NImage,\r\n} from 'naive-ui';\r\nimport { ref, reactive } from 'vue';\r\nimport { getSettingConfigs, updateSettingConfigs } from '@/api/setting';\r\nimport { parseUrlToPath } from '@/common/global';\r\nimport { postPicture } from '@/api/file';\r\n\r\nconst { message, dialog } = createDiscreteApi(['message', 'dialog']);\r\n\r\nconst KEY_NAME = 'name';\r\nconst KEY_LOGO = 'logo';\r\nconst websiteFormRef = ref(null);\r\nconst settingsData = reactive({\r\n  name: {\r\n    id: 1,\r\n    value: null,\r\n  },\r\n  logo: {\r\n    id: 2,\r\n    value: ref(null),\r\n  },\r\n});\r\nconst logoUrl = ref('');\r\n\r\nasync function save() {\r\n  if (settingsData.name.value) {\r\n    await updateSettingConfigs(settingsData.name.id, {\r\n      value: settingsData.name.value,\r\n      // key: KEY_NAME,\r\n    });\r\n  }\r\n  if (settingsData.logo.value) {\r\n    await updateSettingConfigs(settingsData.logo.id, {\r\n      value: settingsData.logo.value,\r\n      // key: KEY_LOGO,\r\n    });\r\n  }\r\n  message.success('操作成功！');\r\n}\r\n\r\nasync function render() {\r\n  const res = await getSettingConfigs();\r\n  const dataList = res.system_configs || [];\r\n  if (dataList.length) {\r\n    const nameSetting = dataList.find((item) => item.key === KEY_NAME);\r\n    const logoSetting = dataList.find((item) => item.key === KEY_LOGO);\r\n    if (nameSetting) {\r\n      // settingsData.name.id = nameSetting.id;\r\n      settingsData.name.value = nameSetting.value;\r\n    }\r\n    if (logoSetting) {\r\n      // settingsData.logo.id = logoSetting.id;\r\n      settingsData.logo.value = logoSetting.value;\r\n      logoUrl.value = parseUrlToPath(logoSetting.value);\r\n      // settingsData.logo.value = 'https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg';\r\n    }\r\n  }\r\n}\r\n\r\nconst uplodFile = ref(null);\r\n\r\nfunction onUpload({ file }) {\r\n  uplodFile.value = file;\r\n  file.status = 'uploading';\r\n  file.percentage = 0;\r\n  const timer = setInterval(() => {\r\n    if (uplodFile.value.status === 'finished') {\r\n      clearInterval(timer);\r\n      return;\r\n    }\r\n    uplodFile.value.percentage += Math.random() * 30;\r\n  }, 1000);\r\n  postPicture(file).then(({ url }) => {\r\n    settingsData.logo.value = url;\r\n    logoUrl.value = parseUrlToPath(url);\r\n    // settingsData.logo.value =\r\n    //   'https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg';\r\n    uplodFile.value.percentage = 100;\r\n    setTimeout(() => {\r\n      uplodFile.value.status = 'finished';\r\n    }, 0);\r\n  });\r\n}\r\n\r\nrender();\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.settings-manage-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n  .website {\r\n    max-width: 400px;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./SettingsManage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingsManage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SettingsManage.vue?vue&type=style&index=0&id=13d11854&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\my\\\\cloud_dist\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-13d11854\"]])\n\nexport default __exports__"],"names":["_hoisted_1","xmlns","viewBox","_hoisted_2","_createElementVNode","fill","stroke","d","_hoisted_3","_hoisted_4","defineComponent","name","render","_ctx","_cache","_openBlock","_createElementBlock","message","dialog","createDiscreteApi","KEY_NAME","KEY_LOGO","websiteFormRef","ref","settingsData","reactive","id","value","logo","logoUrl","async","save","updateSettingConfigs","success","res","getSettingConfigs","dataList","system_configs","length","nameSetting","find","item","key","logoSetting","parseUrlToPath","uplodFile","onUpload","file","status","percentage","timer","setInterval","Math","random","clearInterval","postPicture","then","url","setTimeout","__exports__"],"sourceRoot":""}