"use strict";(self["webpackChunkcloud_dist"]=self["webpackChunkcloud_dist"]||[]).push([[73],{4073:function(e,a,l){l.r(a),l.d(a,{default:function(){return W}});var t=l(3396),n=l(4870),i=l(4120),u=l(5941),o=l(7646),d=l(4165),c=l(3008),r=l(5393),v=l(9436),s=l(6429),m=l(3273),_=l(3612),p=l(9063),f=l(7245);function g(e){return(0,f.Z)({url:"/activation-codes",method:"get",params:e})}function y(e){return(0,f.Z)({url:"/activation-codes",method:"post",data:e})}var b=l(6797),U=l.n(b);const S={class:"activation-code-manage-container"},w={style:{display:"flex","flex-direction":"column"}};var h={__name:"ActivationManage",setup(e){const{message:a}=(0,i.M)(["message"]),l=!0,f=!1,b=[{label:"已使用",value:l},{label:"未使用",value:f}],h=[{label:"1个月",value:30},{label:"2个月",value:60},{label:"3个月",value:90},{label:"6个月",value:180},{label:"1年",value:365},{label:"2年",value:730},{label:"3年",value:1095},{label:"4年",value:1460}],Z=[{title:"编号",key:"activation_code.id"},{title:"激活码",key:"activation_code.code"},{title:"激活分区",key:"category.name"},{title:"有效期",key:"activation_code.valid_duration",render(e){return(0,t.h)("span",null,e.activation_code.valid_duration+"天")}},{title:"状态",key:"status",render(e){return(0,t.h)("span",{style:{color:e.activation_code.user_id?"red":"green"}},e.activation_code.user_id?"已使用":"未使用")}},{title:"创建时间",key:"created_time",render(e){return(0,t.h)("span",null,U()(1e3*e.activation_code.created_time).format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"用户ID",key:"user_id",render(e){return(0,t.h)("span",null,e.activation_code.user_id||"--")}},{title:"使用时间",key:"use_time",render(e){return(0,t.h)("span",null,e.activation_code.use_time?U()(1e3*e.activation_code.use_time).format("YYYY-MM-DD HH:mm:ss"):"--")}}];let k=(0,n.iH)(!0),W=(0,n.iH)(null);async function D(){const e=await(0,p.$R)();W.value=e.items||[],k.value=!1}D();const P=()=>{M.value.page_num=1,I()},H=()=>{M.value.category_id=null,M.value.activated=null,M.value.key=null},Y=(0,n.iH)(null),x=(0,n.qj)({isShow:!1,title:"创建激活码",formData:(0,n.iH)({category_id:null,valid_duration:null,activation_code_count:null}),rules:{category_id:{required:!0,trigger:["blur","change"],message:"请选择分区",type:"number"},valid_duration:{required:!0,trigger:["blur","change"],message:"请选择有效期",type:"number"},activation_code_count:{required:!0,trigger:["blur","input"],message:"请输入数量"}}});function C(){Y.value?.validate((async e=>{e||(await y({...x.formData,activation_code_count:parseInt(x.formData.activation_code_count)}),x.isShow=!1,a.success("操作成功！"),I())})).catch()}(0,t.YP)((()=>x.isShow),(e=>{if(!e)for(const a in x.formData)Object.hasOwnProperty.call(x.formData,a)&&(x.formData[a]=null)}));const M=(0,n.iH)({page_num:1,page_size:10,category_id:null,activated:null,key:null}),q=(0,n.iH)(0),z=(0,n.iH)([]);async function I(){const e=await g(M.value);z.value=e.activation_codes||[],q.value=e.total}function O(e){M.value.page_num=e,I()}return I(),(e,a)=>((0,t.wg)(),(0,t.iD)("div",S,[(0,t.Wm)((0,n.SU)(u.Z),{class:"filter"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"激活分区"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(d.Z),{value:M.value.category_id,"onUpdate:value":a[0]||(a[0]=e=>M.value.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(W),style:{width:"150px"},clearable:""},null,8,["value","options"])])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"状态"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(d.Z),{value:M.value.activated,"onUpdate:value":a[1]||(a[1]=e=>M.value.activated=e),options:b,style:{width:"150px"},clearable:""},null,8,["value"])])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{"label-placement":"left",label:"关键字"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(c.Z),{value:M.value.key,"onUpdate:value":a[2]||(a[2]=e=>M.value.key=e),placeholder:"激活码",clearable:""},null,8,["value"])])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{"label-placement":"left"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(r.ZP),{type:"primary",onClick:P},{default:(0,t.w5)((()=>[(0,t.Uk)(" 查询 ")])),_:1})])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{"label-placement":"left"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(r.ZP),{onClick:H},{default:(0,t.w5)((()=>[(0,t.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1}),(0,t.Wm)((0,n.SU)(u.Z),{class:"action"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(r.ZP),{type:"primary",onClick:a[3]||(a[3]=e=>x.isShow=!0)},{default:(0,t.w5)((()=>[(0,t.Uk)(" 新增激活码 ")])),_:1})])),_:1}),(0,t._)("div",w,[(0,t.Wm)((0,n.SU)(v.Z),{loading:(0,n.SU)(k),columns:Z,data:z.value,bordered:!1,"on-update:page":e=>M.value.page_num=e,"on-update:page-size":e=>M.value.page_size=e},null,8,["loading","data","on-update:page","on-update:page-size"]),(0,t.Wm)((0,n.SU)(s.Z),{page:M.value.page_num,"onUpdate:page":a[4]||(a[4]=e=>M.value.page_num=e),"item-count":q.value,"on-update:page":O,style:{"align-self":"flex-end","margin-top":"10px"}},null,8,["page","item-count"])]),(0,t.Wm)((0,n.SU)(_.Z),{modelValue:x.isShow,"onUpdate:modelValue":a[8]||(a[8]=e=>x.isShow=e),title:x.title,onOnConfirm:C},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(m.Z),{ref_key:"activationRef",ref:Y,model:x.formData,rules:x.rules,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(o.ZP),{label:"激活分区",path:"category_id"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(d.Z),{value:x.formData.category_id,"onUpdate:value":a[5]||(a[5]=e=>x.formData.category_id=e),"label-field":"name","value-field":"id",options:(0,n.SU)(W)},null,8,["value","options"])])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{label:"有效期",path:"valid_duration"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(d.Z),{value:x.formData.valid_duration,"onUpdate:value":a[6]||(a[6]=e=>x.formData.valid_duration=e),options:h},null,8,["value"])])),_:1}),(0,t.Wm)((0,n.SU)(o.ZP),{label:"数量",path:"activation_code_count"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(c.Z),{value:x.formData.activation_code_count,"onUpdate:value":a[7]||(a[7]=e=>x.formData.activation_code_count=e)},null,8,["value"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])]))}},Z=l(89);const k=(0,Z.Z)(h,[["__scopeId","data-v-c29afb2a"]]);var W=k}}]);
//# sourceMappingURL=73.75dbdf22.js.map