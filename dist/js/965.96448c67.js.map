{"version":3,"file":"js/965.96448c67.js","mappings":"ofAqDA,MAAMA,GAASC,EAAAA,EAAAA,IAAS,CAAEC,MAAO,OAEjC,SAASA,IAAS,CAElB,SAASC,IAAS,CAElB,IAAIC,GAAWC,EAAAA,EAAAA,IAAI,IACfC,GAAUD,EAAAA,EAAAA,KAAI,GACdE,GAAiBF,EAAAA,EAAAA,IAAI,GACrBG,GAAiBH,EAAAA,EAAAA,KAAI,GACrBI,GAAcJ,EAAAA,EAAAA,IAAI,MAEtB,MAAMK,GAAaL,EAAAA,EAAAA,IAAI,CACrBM,SAAU,EACVC,UAAW,KAEPC,EAAU,CACd,CACEC,MAAO,OACPC,IAAK,MAEP,CACED,MAAO,MACPC,IAAK,aAEP,CACED,MAAO,OACPC,IAAK,aAEP,CACED,MAAO,KACPC,IAAK,SACLC,OAAOC,GACL,OAAOC,EAAAA,EAAAA,GAAE,MAAO,CAAEC,MAAO,CAAEC,MAAO,UAAWC,OAAQ,YAAe,EAClEH,EAAAA,EAAAA,GACE,OACA,CACEC,MAAO,CAAE,eAAgB,QACzBG,QAAS,QAIX,OAEFJ,EAAAA,EAAAA,GACE,OACA,CACEI,QAAS,KACPb,EAAYc,MAAQN,EACpBT,EAAee,OAAQ,CAAI,GAG/B,SAGN,KAIJC,EAAAA,EAAAA,KAAU,KACR,MAAMC,EAAe,GACfC,EAAoB,GACpBC,EAAmB,GACnBC,EAAmB,GACzBrB,EAAegB,MACbM,SAASC,cAAc,2BAA2BC,aAClDN,EACAC,EACAC,EACAC,CAAgB,IAGpB,MAAM,QAAEI,IAAYC,EAAAA,EAAAA,GAAkB,CAAC,YAEvCC,eAAeC,IACb,MAAMC,QAAYC,EAAAA,EAAAA,IAAY3B,EAAWa,OACzCnB,EAASmB,MAAQa,EAAIE,OAAS,GAC9BhC,EAAQiB,OAAQ,CAClB,CAIAW,eAAeK,UACPC,EAAAA,EAAAA,IAAW/B,EAAYc,MAAMkB,GAAI,CAAEC,SAAU,WACnDlC,EAAee,OAAQ,EACvBS,EAAQW,QAAQ,QAClB,C,OANAR,I,iiCC/HA,MAAMS,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cloud_dist/./src/views/pc/UsersManage.vue","webpack://cloud_dist/./src/views/pc/UsersManage.vue?3127"],"sourcesContent":["<template>\r\n  <div class=\"users-manage-container\">\r\n    <n-space class=\"filter\">\r\n      <n-form-item label-placement=\"left\" label=\"关键字\">\r\n        <n-input\r\n          v-model:value=\"filter.query\"\r\n          placeholder=\"用户名/用户ID/激活码\"\r\n        ></n-input>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button type=\"primary\" @click=\"query\"> 查询 </n-button>\r\n      </n-form-item>\r\n      <n-form-item label-placement=\"left\">\r\n        <n-button @click=\"reset\"> 重置 </n-button>\r\n      </n-form-item>\r\n    </n-space>\r\n\r\n    <n-data-table\r\n      :max-height=\"tableMaxHeight\"\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :data=\"userList\"\r\n      :pagination=\"true\"\r\n      :bordered=\"false\"\r\n    />\r\n\r\n    <popup-window\r\n      v-model=\"isShowPwdAlert\"\r\n      title=\"重置密码\"\r\n      :width=\"300\"\r\n      @on-confirm=\"resetPwd\"\r\n    >\r\n      <div>确定重置密码吗？</div>\r\n      <div>重置后新密码为：123456</div>\r\n    </popup-window>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  createDiscreteApi,\r\n  NFormItem,\r\n  NInput,\r\n  NForm,\r\n  NButton,\r\n  NDataTable,\r\n  NSpace,\r\n} from 'naive-ui';\r\nimport { ref, h, onMounted, reactive, computed } from 'vue';\r\nimport PopupWindow from '@/components/pc/PopupWindow.vue';\r\nimport { getUserList, updateUser } from '@/api/user';\r\nimport { getTableMaxHeight } from '@/common/global';\r\n\r\nconst filter = reactive({ query: null });\r\n\r\nfunction query() {}\r\n\r\nfunction reset() {}\r\n\r\nlet userList = ref([]);\r\nlet loading = ref(true);\r\nlet tableMaxHeight = ref(0);\r\nlet isShowPwdAlert = ref(false);\r\nlet selectedRow = ref(null);\r\n\r\nconst userParams = ref({\r\n  page_num: 1,\r\n  page_size: 10,\r\n});\r\nconst columns = [\r\n  {\r\n    title: '用户ID',\r\n    key: 'id',\r\n  },\r\n  {\r\n    title: '用户名',\r\n    key: 'user_name',\r\n  },\r\n  {\r\n    title: '用户类型',\r\n    key: 'user_type',\r\n  },\r\n  {\r\n    title: '操作',\r\n    key: 'action',\r\n    render(row) {\r\n      return h('div', { style: { color: '#18a058', cursor: 'pointer' } }, [\r\n        h(\r\n          'span',\r\n          {\r\n            style: { 'margin-right': '10px' },\r\n            onClick: () => {\r\n              // TODO: 跳转到详情页\r\n            },\r\n          },\r\n          '详情'\r\n        ),\r\n        h(\r\n          'span',\r\n          {\r\n            onClick: () => {\r\n              selectedRow.value = row;\r\n              isShowPwdAlert.value = true;\r\n            },\r\n          },\r\n          '重置密码'\r\n        ),\r\n      ]);\r\n    },\r\n  },\r\n];\r\n\r\nonMounted(() => {\r\n  const filterHeight = 58;\r\n  const tableHeaderHeight = 47;\r\n  const paginationHeight = 28 + 12;\r\n  const containerPadding = 10 * 2;\r\n  tableMaxHeight.value =\r\n    document.querySelector('.users-manage-container').offsetHeight -\r\n    filterHeight -\r\n    tableHeaderHeight -\r\n    paginationHeight -\r\n    containerPadding;\r\n});\r\n\r\nconst { message } = createDiscreteApi(['message']);\r\n\r\nasync function renderUserList() {\r\n  const res = await getUserList(userParams.value);\r\n  userList.value = res.users || [];\r\n  loading.value = false;\r\n}\r\n\r\nrenderUserList();\r\n\r\nasync function resetPwd() {\r\n  await updateUser(selectedRow.value.id, { password: '123456' });\r\n  isShowPwdAlert.value = false;\r\n  message.success('操作成功！');\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.users-manage-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n}\r\n</style>\r\n","import script from \"./UsersManage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UsersManage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UsersManage.vue?vue&type=style&index=0&id=abc17df6&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\my\\\\cloud_dist\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-abc17df6\"]])\n\nexport default __exports__"],"names":["filter","reactive","query","reset","userList","ref","loading","tableMaxHeight","isShowPwdAlert","selectedRow","userParams","page_num","page_size","columns","title","key","render","row","h","style","color","cursor","onClick","value","onMounted","filterHeight","tableHeaderHeight","paginationHeight","containerPadding","document","querySelector","offsetHeight","message","createDiscreteApi","async","renderUserList","res","getUserList","users","resetPwd","updateUser","id","password","success","__exports__"],"sourceRoot":""}